{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"validate\", \"validationMessage\", \"validateOnBlur\", \"validateOnChange\", \"validateOnStart\", \"onChangeValidity\"];\nimport _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport { useCallback, useState, useEffect, useMemo } from 'react';\nimport * as Presenter from \"./Presenter\";\nimport { useDidUpdate } from \"../../hooks\";\nimport { Constants } from \"../../commons/new\";\nexport default function useFieldState(_ref) {\n  var _props$value;\n  var validate = _ref.validate,\n    validationMessage = _ref.validationMessage,\n    validateOnBlur = _ref.validateOnBlur,\n    validateOnChange = _ref.validateOnChange,\n    validateOnStart = _ref.validateOnStart,\n    onChangeValidity = _ref.onChangeValidity,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var _useState = useState((_props$value = props.value) != null ? _props$value : props.defaultValue),\n    _useState2 = _slicedToArray(_useState, 2),\n    value = _useState2[0],\n    setValue = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isFocused = _useState4[0],\n    setIsFocused = _useState4[1];\n  var _useState5 = useState(undefined),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isValid = _useState6[0],\n    setIsValid = _useState6[1];\n  var _useState7 = useState(undefined),\n    _useState8 = _slicedToArray(_useState7, 2),\n    failingValidatorIndex = _useState8[0],\n    setFailingValidatorIndex = _useState8[1];\n  useEffect(function () {\n    if (Constants.isWeb && !props.value && props.defaultValue && props.defaultValue !== value) {\n      setValue(props.defaultValue);\n      if (validateOnStart) {\n        validateField(props.defaultValue);\n      }\n    }\n  }, [props.defaultValue, validateOnStart]);\n  useEffect(function () {\n    if (validateOnStart) {\n      validateField();\n    }\n  }, []);\n  useEffect(function () {\n    if (props.value !== value) {\n      setValue(props.value);\n      if (validateOnChange && (_isUndefined(props.defaultValue) || value !== props.defaultValue)) {\n        validateField(props.value);\n      }\n    }\n  }, [props.value, validateOnChange]);\n  useDidUpdate(function () {\n    if (!_isUndefined(isValid)) {\n      onChangeValidity == null ? void 0 : onChangeValidity(isValid);\n    }\n  }, [isValid]);\n  var checkValidity = useCallback(function () {\n    var valueToValidate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : value;\n    var _Presenter$validate = Presenter.validate(valueToValidate, validate),\n      _Presenter$validate2 = _slicedToArray(_Presenter$validate, 1),\n      _isValid = _Presenter$validate2[0];\n    return _isValid;\n  }, [value, validate]);\n  var validateField = useCallback(function () {\n    var valueToValidate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : value;\n    var _Presenter$validate3 = Presenter.validate(valueToValidate, validate),\n      _Presenter$validate4 = _slicedToArray(_Presenter$validate3, 2),\n      _isValid = _Presenter$validate4[0],\n      _failingValidatorIndex = _Presenter$validate4[1];\n    setIsValid(_isValid);\n    setFailingValidatorIndex(_failingValidatorIndex);\n    return _isValid;\n  }, [value, validate]);\n  var onFocus = useCallback(function () {\n    setIsFocused(true);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    props.onFocus == null ? void 0 : props.onFocus.apply(props, args);\n  }, [props.onFocus]);\n  var onBlur = useCallback(function () {\n    setIsFocused(false);\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    props.onBlur == null ? void 0 : props.onBlur.apply(props, args);\n    if (validateOnBlur) {\n      validateField();\n    }\n  }, [props.onBlur, validateOnBlur, validateField]);\n  var onChangeText = useCallback(function (text) {\n    setValue(text);\n    props.onChangeText == null ? void 0 : props.onChangeText(text);\n    if (validateOnChange) {\n      validateField(text);\n    }\n  }, [props.onChangeText, validateOnChange, validateField]);\n  var fieldState = useMemo(function () {\n    return {\n      value: value,\n      hasValue: !_isEmpty(value),\n      isValid: validationMessage && !validate ? false : isValid != null ? isValid : true,\n      isFocused: isFocused,\n      failingValidatorIndex: failingValidatorIndex\n    };\n  }, [value, isFocused, isValid, failingValidatorIndex, validationMessage, validate]);\n  return {\n    onFocus: onFocus,\n    onBlur: onBlur,\n    onChangeText: onChangeText,\n    fieldState: fieldState,\n    validateField: validateField,\n    checkValidity: checkValidity\n  };\n}","map":{"version":3,"names":["_isEmpty","_isUndefined","useCallback","useState","useEffect","useMemo","Presenter","useDidUpdate","Constants","useFieldState","_ref","_props$value","validate","validationMessage","validateOnBlur","validateOnChange","validateOnStart","onChangeValidity","props","_objectWithoutProperties","_excluded","_useState","value","defaultValue","_useState2","_slicedToArray","setValue","_useState3","_useState4","isFocused","setIsFocused","_useState5","undefined","_useState6","isValid","setIsValid","_useState7","_useState8","failingValidatorIndex","setFailingValidatorIndex","isWeb","validateField","checkValidity","valueToValidate","arguments","length","_Presenter$validate","_Presenter$validate2","_isValid","_Presenter$validate3","_Presenter$validate4","_failingValidatorIndex","onFocus","_len","args","Array","_key","apply","onBlur","_len2","_key2","onChangeText","text","fieldState","hasValue"],"sources":["/workspaces/expo-starter/node_modules/react-native-ui-lib/src/incubator/TextField/useFieldState.js"],"sourcesContent":["import _isEmpty from \"lodash/isEmpty\";\nimport _isUndefined from \"lodash/isUndefined\";\nimport { useCallback, useState, useEffect, useMemo } from 'react';\nimport * as Presenter from \"./Presenter\";\nimport { useDidUpdate } from \"../../hooks\";\nimport { Constants } from \"../../commons/new\";\nexport default function useFieldState({\n  validate,\n  validationMessage,\n  validateOnBlur,\n  validateOnChange,\n  validateOnStart,\n  onChangeValidity,\n  ...props\n}) {\n  const [value, setValue] = useState(props.value ?? props.defaultValue);\n  const [isFocused, setIsFocused] = useState(false);\n  const [isValid, setIsValid] = useState(undefined);\n  const [failingValidatorIndex, setFailingValidatorIndex] = useState(undefined);\n  useEffect(() => {\n    if (Constants.isWeb && !props.value && props.defaultValue && props.defaultValue !== value) {\n      setValue(props.defaultValue);\n      if (validateOnStart) {\n        validateField(props.defaultValue);\n      }\n    }\n\n    /* On purpose listen only to props.defaultValue change */\n    /* eslint-disable-next-line react-hooks/exhaustive-deps*/\n  }, [props.defaultValue, validateOnStart]);\n  useEffect(() => {\n    if (validateOnStart) {\n      validateField();\n    }\n  }, []);\n  useEffect(() => {\n    if (props.value !== value) {\n      setValue(props.value);\n      if (validateOnChange && (_isUndefined(props.defaultValue) || value !== props.defaultValue)) {\n        validateField(props.value);\n      }\n    }\n    /* On purpose listen only to props.value change */\n    /* eslint-disable-next-line react-hooks/exhaustive-deps*/\n  }, [props.value, validateOnChange]);\n  useDidUpdate(() => {\n    if (!_isUndefined(isValid)) {\n      onChangeValidity?.(isValid);\n    }\n  }, [isValid]);\n  const checkValidity = useCallback((valueToValidate = value) => {\n    const [_isValid] = Presenter.validate(valueToValidate, validate);\n    return _isValid;\n  }, [value, validate]);\n  const validateField = useCallback((valueToValidate = value) => {\n    const [_isValid, _failingValidatorIndex] = Presenter.validate(valueToValidate, validate);\n    setIsValid(_isValid);\n    setFailingValidatorIndex(_failingValidatorIndex);\n    return _isValid;\n  }, [value, validate]);\n  const onFocus = useCallback((...args) => {\n    setIsFocused(true);\n    //@ts-expect-error\n    props.onFocus?.(...args);\n  }, [props.onFocus]);\n  const onBlur = useCallback((...args) => {\n    setIsFocused(false);\n    //@ts-expect-error\n    props.onBlur?.(...args);\n    if (validateOnBlur) {\n      validateField();\n    }\n  }, [props.onBlur, validateOnBlur, validateField]);\n  const onChangeText = useCallback(text => {\n    setValue(text);\n    props.onChangeText?.(text);\n    if (validateOnChange) {\n      validateField(text);\n    }\n  }, [props.onChangeText, validateOnChange, validateField]);\n  const fieldState = useMemo(() => {\n    return {\n      value,\n      hasValue: !_isEmpty(value),\n      isValid: validationMessage && !validate ? false : isValid ?? true,\n      isFocused,\n      failingValidatorIndex\n    };\n  }, [value, isFocused, isValid, failingValidatorIndex, validationMessage, validate]);\n  return {\n    onFocus,\n    onBlur,\n    onChangeText,\n    fieldState,\n    validateField,\n    checkValidity\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}